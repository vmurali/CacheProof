Correct implementation of cache coherent systems is of high importance in
industrial use. We first provide a concise mathematical definition of a cache
coherent system as one which obeys store atomicity. We give a Coq-based proof
of an MSI cache coherence protocol for an infinite set of cache hierarchies. We
specify a set of invariants which imply store atomicity, enabling other
protocols to be verified for store atomicity automatically as long as they
satisfy the invariants. Our key insight for proving these invariants is a set
of fundamental properties.  We believe that these fundamental properties are
true for many other invalidation-based protocols with no silent drops -- we
show that informally for MESI, MOSI and MOESI protocols.

%Previously, it has been shown
%that these atomic transitions can be translated automatically into efficient
%hardware. Verifying the specification based on atomic transitions therefore
%guarantees the correctness of the actual implementation.
%The proof is built in a modular fashion, identifying key invariants common with
%other protocols like MESI, MOSI, \etc. We informally show how these other
%protocols can be proved reusing modules from the proof of the MSI protocol.

